var nth=nth||{};!function(a,b,c,d,e){"use strict";function f(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}nth.grid={$base:a("#base"),brickHeight:10,brickWidth:10,hoverInterval:null,hoverStep:5,hoverDelay:10,gridIsActive:!1,init:function(){var a=this;c.MediaQuery.atLeast("medium")&&a.drawGrid(),a.bindEvents()},drawGrid:function(){for(var a=this,b=Math.ceil((a.$base.width()+2*a.brickWidth)/a.brickWidth),c=Math.ceil(a.$base.height()/a.brickHeight),d=0;d<c;d+=1){for(var e='<span class="r" id="r'+d+'">',f=0;f<b;f+=1)e+='<span class="b" id="b'+d+"-"+f+'"></span>';e+="</span>",a.$base.append(e)}a.load()},bindEvents:function(){var b=this;a(".b").on("mouseover",function(){var c=a(this);b.gridIsActive=!0,clearInterval(b.hoverInterval),b.hoverInterval=setInterval(function(){if(!c.attr("data-disabled")){var a=c.css("background-color"),d=a.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),e=1*d[0];e>0&&(e<b.hoverStep?e=0:e-=b.hoverStep);var f=e,g=e;c.css("background-color","rgb("+e.toString()+", "+f.toString()+", "+g.toString()+")")}},b.hoverDelay)}).on("mouseout",function(){var c=a(this);clearInterval(b.hoverInterval),b.gridIsActive=!1,c.attr("data-disabled",null),setTimeout(b.save.bind(b),1e3)}).on("click",function(){var b=a(this);b.css("background-color","rgb(255, 255, 255)"),b.attr("data-disabled","1")}),a(d).on("resize",f(function(){b.drawGrid()},300))},load:function(){var b=this.getStorageKey(),c=d.localStorage.getItem(b),e=JSON.parse(c);if(e)for(var f in e.data)if(e.data.hasOwnProperty(f)){var g="#"+f;a(g).css("background-color",e.data[f])}},save:function(){if(!this.gridIsActive){var b=this.$base.find(".r"),c={};if(b.length>0){b.each(function(){var b=a(this),d=b.find(".b[style]");d.length>0&&d.each(function(){var b=a(this).attr("id");c[b]=a(this).css("background-color")})});var e=this.getStorageKey(),f=JSON.stringify({data:c});d.localStorage.setItem(e,f)}}},getStorageKey:function(){return d.location.hostname+"-"+d.location.pathname.replace("/","").replace(".","")+"-grid"}}}(window.jQuery,window.Modernizr,window.Foundation,window,window.document),jQuery(function(){"use strict";nth.grid.init()});